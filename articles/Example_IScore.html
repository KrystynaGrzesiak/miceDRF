<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Energy-I-Score: First Steps • miceDRF</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Energy-I-Score: First Steps">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">miceDRF</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/About_IScore.html">Energy-I-Score: Implementation Details</a></li>
    <li><a class="dropdown-item" href="../articles/Example_IScore.html">Energy-I-Score: First Steps</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/KrystynaGrzesiak/miceDRF/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Energy-I-Score: First Steps</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KrystynaGrzesiak/miceDRF/blob/master/vignettes/Example_IScore.Rmd" class="external-link"><code>vignettes/Example_IScore.Rmd</code></a></small>
      <div class="d-none name"><code>Example_IScore.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>This vignette provides a basic introduction to using the
<code>miceDRF</code> package.<br>
To install the latest development version directly from GitHub, run the
following code in your R console:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"KrystynaGrzesiak/miceDRF"</span><span class="op">)</span></span></code></pre></div>
<p>After installation, load the package and set a random seed to ensure
reproducibility:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KrystynaGrzesiak/miceDRF" class="external-link">miceDRF</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">17</span><span class="op">)</span></span></code></pre></div>
<p>We will begin by loading the example dataset <code>windspeed</code>
from the <code>mice</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/amices/mice" class="external-link">mice</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'mice'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cbind, rbind</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">windspeed</span><span class="op">)</span></span>
<span><span class="co">#&gt;   RochePt Rosslare Shannon Dublin Clones MalinHead</span></span>
<span><span class="co">#&gt; 1    4.92     7.29    3.67   3.71   2.71      7.83</span></span>
<span><span class="co">#&gt; 2   22.50    19.41   16.13  16.08  16.58     19.67</span></span>
<span><span class="co">#&gt; 3    7.54     9.29   11.00   1.71   9.71     15.37</span></span>
<span><span class="co">#&gt; 4    6.29     6.75    8.25   8.46  10.29     15.46</span></span>
<span><span class="co">#&gt; 5   10.34    11.29    9.38   8.71   8.42     11.12</span></span>
<span><span class="co">#&gt; 6   10.63    11.38    5.71   6.54   5.17      6.38</span></span></code></pre></div>
<p>Next, we will introduce some missing values using the
<code><a href="https://amices.org/mice/reference/ampute.html" class="external-link">ampute()</a></code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">windspeed_miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/ampute.html" class="external-link">ampute</a></span><span class="op">(</span><span class="va">windspeed</span>, <span class="fl">0.2</span>, mech  <span class="op">=</span> <span class="st">"MAR"</span><span class="op">)</span><span class="op">$</span><span class="va">amp</span></span></code></pre></div>
<p>Finally, let’s check the proportion of missing values in each
column:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">windspeed_miss</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    RochePt   Rosslare    Shannon     Dublin     Clones  MalinHead </span></span>
<span><span class="co">#&gt; 0.05080831 0.03695150 0.03233256 0.03002309 0.03002309 0.02309469</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="imputation-function">Imputation Function<a class="anchor" aria-label="anchor" href="#imputation-function"></a>
</h3>
<p>Before we can compute the <em>energy-I-Score</em>, we need to define
the <strong>imputation method</strong> that will be applied to the
dataset with missing values. The <code>miceDRF</code> package is
flexible — it allows you to use <strong>any imputation
strategy</strong>, as long as your function follows a few simple
rules.</p>
<p>Your imputation function:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Must accept</strong> a dataset with missing values as its
only required argument.<br>
</li>
<li>
<strong>Must return</strong> a dataset of the same dimensions, with
missing values filled in.<br>
</li>
<li>
<strong>Should not require any additional non-default
arguments</strong> — the function will be called internally by the
scoring procedure.</li>
<li>Can be:
<ul>
<li>a simple custom function (e.g. mean imputation),</li>
<li>a wrapper around a more complex method (e.g. random forests,
Bayesian models, <code>mice</code>, <code>missForest</code>),</li>
<li>or any other approach that returns a fully imputed dataset.</li>
</ul>
</li>
</ol>
<p>For example, let’s define <em>zero imputation</em> below</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">impute_zero</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span> <span class="va">X</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>; <span class="va">X</span> <span class="op">}</span></span></code></pre></div>
<p>Additionally, the <code>miceDRF</code> package provides a convenient
way to quickly implement imputation methods from the <code>mice</code>
package that are fully compatible with the energy-I-Score. You can
simply use <code><a href="../reference/create_mice_imputation.html">create_mice_imputation()</a></code> with the name of the
method (for the list of methods see <code><a href="https://amices.org/mice/reference/mice.html" class="external-link">?mice::mice</a></code>) as below
<em>random forest imputation</em>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://imbs-hl.github.io/ranger/" class="external-link">ranger</a></span><span class="op">)</span>                                  <span class="co"># for random forest imputation</span></span>
<span><span class="va">impute_rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_mice_imputation.html">create_mice_imputation</a></span><span class="op">(</span><span class="st">"rf"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="energy-i-score">Energy-I-Score<a class="anchor" aria-label="anchor" href="#energy-i-score"></a>
</h3>
<p>To calculate Energy-I-Score we need to provide imputation method
along with incomplete and imputed datasets. Let’s see an example for
random forest imputation:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Iscore.html">Iscore</a></span><span class="op">(</span><span class="va">windspeed_miss</span>, <span class="fu">impute_rf</span><span class="op">(</span><span class="va">windspeed_miss</span><span class="op">)</span>, imputation_func <span class="op">=</span> <span class="va">impute_rf</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sc</span></span>
<span><span class="co">#&gt; [1] 2.719471</span></span>
<span><span class="co">#&gt; attr(,"dat")</span></span>
<span><span class="co">#&gt;           column_id     weight    score n_columns_used</span></span>
<span><span class="co">#&gt; RochePt           1 0.04822683 2.865981              1</span></span>
<span><span class="co">#&gt; Rosslare          2 0.03558609 3.239500              1</span></span>
<span><span class="co">#&gt; Shannon           3 0.03128717 2.765237              1</span></span>
<span><span class="co">#&gt; Dublin            4 0.02912171 2.181387              1</span></span>
<span><span class="co">#&gt; Clones            5 0.02912171 1.986160              1</span></span>
<span><span class="co">#&gt; MalinHead         6 0.02256132 3.163669              1</span></span></code></pre></div>
<p>The result is a single score summarizing the performance across all
columns that required imputation. In addition, a table with scores
calculated for each column separately is also returned as an attribute
of the result. The table says what were score, weight and number of
columns used for the training part for each column. To access this
table, simply use the <code><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">sc</span>, <span class="st">"dat"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           column_id     weight    score n_columns_used</span></span>
<span><span class="co">#&gt; RochePt           1 0.04822683 2.865981              1</span></span>
<span><span class="co">#&gt; Rosslare          2 0.03558609 3.239500              1</span></span>
<span><span class="co">#&gt; Shannon           3 0.03128717 2.765237              1</span></span>
<span><span class="co">#&gt; Dublin            4 0.02912171 2.181387              1</span></span>
<span><span class="co">#&gt; Clones            5 0.02912171 1.986160              1</span></span>
<span><span class="co">#&gt; MalinHead         6 0.02256132 3.163669              1</span></span></code></pre></div>
<p>The <code><a href="../reference/Iscore.html">Iscore()</a></code> function exposes several parameters that
control how the Energy-I-Score is computed.<br>
Below we illustrate the most important ones with concise examples.</p>
<p>The parameter <code>N</code> controls how many times the missing part
is re-imputed to estimate the score (only relevant if your method is
multiple). Let us note that for deterministic methods, <code>N</code> is
effectively ignored (when <code>multiple = FALSE</code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Iscore.html">Iscore</a></span><span class="op">(</span><span class="va">windspeed_miss</span>, <span class="fu">impute_rf</span><span class="op">(</span><span class="va">windspeed_miss</span><span class="op">)</span>, imputation_func <span class="op">=</span> <span class="va">impute_rf</span>, N <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.520822</span></span>
<span><span class="co">#&gt; attr(,"dat")</span></span>
<span><span class="co">#&gt;           column_id     weight    score n_columns_used</span></span>
<span><span class="co">#&gt; RochePt           1 0.04822683 3.771838              1</span></span>
<span><span class="co">#&gt; Rosslare          2 0.03558609 3.616765              1</span></span>
<span><span class="co">#&gt; Shannon           3 0.03128717 3.867273              1</span></span>
<span><span class="co">#&gt; Dublin            4 0.02912171 3.082888              1</span></span>
<span><span class="co">#&gt; Clones            5 0.02912171 3.136965              1</span></span>
<span><span class="co">#&gt; MalinHead         6 0.02256132 3.413230              1</span></span></code></pre></div>
<p>When working with datasets that contain many columns with missing
values, calculating the energy-I-Score for all of them can be
time-consuming. To make the computation faster, you can <strong>limit
the number of columns used for scoring</strong> by setting the
<code>max_length</code> parameter. This parameter defines how many
variables (columns) will be used to compute the score. The function
automatically selects the variables <strong>with the largest number of
missing values first</strong>. By default,
<code>max_length = NULL</code>, which means that <strong>all
columns</strong> with missing data are included in the calculation.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Iscore.html">Iscore</a></span><span class="op">(</span><span class="va">windspeed_miss</span>, <span class="fu">impute_rf</span><span class="op">(</span><span class="va">windspeed_miss</span><span class="op">)</span>, imputation_func <span class="op">=</span> <span class="va">impute_rf</span>, max_length <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.458355</span></span>
<span><span class="co">#&gt; attr(,"dat")</span></span>
<span><span class="co">#&gt;          column_id     weight    score n_columns_used</span></span>
<span><span class="co">#&gt; RochePt          1 0.04822683 3.332980              1</span></span>
<span><span class="co">#&gt; Rosslare         2 0.03558609 3.628264              1</span></span></code></pre></div>
<p>Some variables may lack fully observed predictors among rows needed
for training the conditional imputations. Thus, we can specify</p>
<ul>
<li><p><code>skip_if_needed = TRUE</code> (default): try to skip minimal
rows to obtain a workable design; proceed with scoring.</p></li>
<li><p><code>skip_if_needed = FALSE</code>: if no complete predictors
can be formed, the score for that variable is returned as NA.</p></li>
</ul>
<p>Additionally, we can adopt some scaling by <code>scale = TRUE</code>
to ensure each variable is standardized internally before computing
distances. This prevents variables with large numeric ranges from
dominating the score.</p>
<div class="section level4">
<h4 id="summary-of-best-practices">Summary of best practices<a class="anchor" aria-label="anchor" href="#summary-of-best-practices"></a>
</h4>
<ul>
<li><p>Use <code>multiple = TRUE</code> with a genuinely multiple
imputers and determine <code>N</code> for stable estimates.</p></li>
<li><p>Consider <code>scale = TRUE</code> when mixing variables on
different scales.</p></li>
<li><p>Use <code>max_length</code> for quick experiments; remove it for
final runs.</p></li>
<li><p>Keep <code>skip_if_needed = TRUE</code> unless you explicitly
want to flag unscorable columns with NA.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="comparisons-of-energy-i-scores">Comparisons of energy-I-Scores<a class="anchor" aria-label="anchor" href="#comparisons-of-energy-i-scores"></a>
</h4>
<p>We also provide functionality for <strong>quick benchmarking</strong>
of different imputation methods. To run Energy-I-Scores for more than
one imputation function at once, use the <code><a href="../reference/Iscores_compare.html">Iscores_compare()</a></code>
function. You simply need to provide an incomplete dataset and a
<strong>list of imputation functions</strong>, as shown below:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imputation_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rf <span class="op">=</span> <span class="va">impute_rf</span>, zero <span class="op">=</span> <span class="va">impute_zero</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Iscores_compare.html">Iscores_compare</a></span><span class="op">(</span><span class="va">windspeed_miss</span>, <span class="va">imputation_list</span>, N <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Calculating score for method: rf"</span></span>
<span><span class="co">#&gt; [1] "Calculating score for method: zero"</span></span>
<span><span class="co">#&gt;        rf      zero </span></span>
<span><span class="co">#&gt;  3.083034 11.063610</span></span></code></pre></div>
<p>In the example above, we compare random forest imputation with a
simple zero imputation method. According to the results, the random
forest method yields a lower Energy-I-Score, indicating better
imputation quality compared to the zero imputation baseline.</p>
</div>
</div>
<div class="section level3">
<h3 id="energy-i-score-for-mixed-datasets">Energy-I-Score for mixed datasets<a class="anchor" aria-label="anchor" href="#energy-i-score-for-mixed-datasets"></a>
</h3>
<p>When the data is mixed, i.e. it contains both categorical and
numerical variables, you can use <code>IScore_cat()</code> function
which is able to calculate scores on categorical columns. Before using
it make sure that all the variables that contain categorical values are
stored as <strong>factors</strong>.</p>
</div>
<div class="section level3">
<h3 id="energy-score">Energy score<a class="anchor" aria-label="anchor" href="#energy-score"></a>
</h3>
<p>If you have access to the original dataset before imputation, you can
also use the energy distance as an additional evaluation metric. Our
package provides an easy-to-use wrapper <code><a href="../reference/energy_dist.html">energy_dist()</a></code>
around the <code><a href="https://rdrr.io/pkg/energy/man/eqdist.etest.html" class="external-link">energy::eqdist.e</a></code> function from the energy
package. You can use it providing complete and imputed datasets:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/energy_dist.html">energy_dist</a></span><span class="op">(</span><span class="va">windspeed</span>, <span class="fu">impute_rf</span><span class="op">(</span><span class="va">windspeed_miss</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; E-statistic </span></span>
<span><span class="co">#&gt;    0.763335</span></span>
<span></span>
<span><span class="fu"><a href="../reference/energy_dist.html">energy_dist</a></span><span class="op">(</span><span class="va">windspeed</span>, <span class="fu">impute_zero</span><span class="op">(</span><span class="va">windspeed_miss</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; E-statistic </span></span>
<span><span class="co">#&gt;    29.18786</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>This approach follows the methodology proposed by Näf, Grzesiak, and
Scornet (2025) in “How to rank imputation methods?”
(arXiv:2507.11297).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Krystyna Grzesiak, Jeffrey Näf.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
